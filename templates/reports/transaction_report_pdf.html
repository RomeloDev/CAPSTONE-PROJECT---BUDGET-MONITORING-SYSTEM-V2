{% extends "reports/report_template.html" %}
{% load humanize %}

{% block report_content %}
<!-- Date Range Subheader -->
<div style="text-align: center; margin-bottom: 20px; font-style: italic;">
    {% if date_from and date_to %}
        Period: {{ date_from }} to {{ date_to }}
    {% elif date_from %}
        Period: From {{ date_from }}
    {% elif date_to %}
        Period: Until {{ date_to }}
    {% else %}
        Period: All Time History
    {% endif %}
</div>

<table class="data-table">
    <thead>
        <tr>
            <th style="width: 15%;">Date</th>
            <th style="width: 10%;">Type</th>
            <th style="width: 15%;">Reference</th>
            <th style="width: 30%;">Particulars / Line Item</th>
            <th style="width: 10%;">Quarter</th>
            <th style="width: 10%;">Status</th>
            <th style="width: 10%;">Amount</th>
        </tr>
    </thead>
    <tbody>
        {% for trans in transactions %}
        <tr>
            <td>{{ trans.date|date:"M d, Y" }}</td>
            <td style="text-align: center;">
                <span style="
                    {% if trans.type == 'PRE' %}color: #6b21a8; font-weight: bold;
                    {% elif trans.type == 'PR' %}color: #1e40af; font-weight: bold;
                    {% elif trans.type == 'AD' %}color: #065f46; font-weight: bold;
                    {% elif trans.type == 'Realignment' %}color: #9a3412; font-weight: bold;
                    {% endif %}">
                    {{ trans.type }}
                </span>
            </td>
            <td>{{ trans.number }}</td>
            <td>{{ trans.line_item }}</td>
            <td style="text-align: center;">{{ trans.quarter }}</td>
            <td style="text-align: center;">{{ trans.status }}</td>
            <td style="text-align: right;">Php {{ trans.amount|floatformat:2|intcomma }}</td>
        </tr>
        {% empty %}
        <tr>
            <td colspan="7" style="text-align: center; padding: 20px; font-style: italic;">No transactions found for this period.</td>
        </tr>
        {% endfor %}
    </tbody>
    <tfoot>
        <tr class="total-row">
            <td colspan="6" style="text-align: right;">TOTAL Transactions Found:</td>
            <td style="text-align: right;">{{ total_records }}</td>
        </tr>
    </tfoot>
</table>

<div class="notes">
    <p><strong>Note:</strong> This report includes all Program of Receipts and Expenditures (PRE), Purchase Requests (PR), Activity Designs (AD), and Budget Realignments recorded in the system.</p>
</div>
{% endblock %}
